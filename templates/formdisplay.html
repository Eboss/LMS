<html>
<title>Formshow</title>
<body>
    <h1 style="color:blue;background-color:blue;color:white;text-align:center;">
        <a style="font-size:15px;color: white;font-family: verdana;font-weight: bold;float:left;text-decoration:underline;" id="signup_popup"> Add User 
              <div id="popup1"></div>
              <div id="popup_modal1">
              <div id="close">X</div>
                    <form style="border:1px solid blue;margin-left:28%;margin-right:33%;border-radius:10px;border-width:2px;background-color:gray;color:white;"><br>
                    Username:<input type="text" id="username" style = "margin-left:3%"><br><br>
                    Password:&nbsp;<input type="password" id="password" style = "margin-left:3%"><br><br>
                    Gender:&nbsp;&nbsp;&nbsp;&nbsp;<select id="gender" style = "margin-left:3%;width: 175px;
                    height: 24px;">
                       <option value="male">Male</option>
                         <option value="female">Female</option></select><br><br>
                    DOB:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="date" id="dob" style = "margin-left:3%;width:176px"><br><br>
                    Mail Id:&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" id="mail" style = "margin-left:3%;width:176px"><br><br>
                    Mob:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" id="mob" style = "margin-left:3%;width:176px"><br><br>
                    <button type="submit" onclick="adduser()"size="50px"style = "margin-top: 3px;
                    margin-left: 39%;
                    width: 101px;
                    height: 31px;
                    border-radius: 18px;
                    color: blue;
                    border-color: white;
                    font-size: 17px;">Save</button><br><br>
                    </form>
              </div>

        </a>
            <span style="text-align:center;">User Leave Request</span>
            <!-- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -->
        <a style="font-size:15px;color: white;font-family: verdana;font-weight: bold;float:right;text-decoration:underline;" href="/logout/">Logout </a>
    </h1>

<div>
 
    <table style="margin-top:-1.5%;height:600px" cellpadding="0" cellspacing="0">
        <tr>
            <td style="background-color:#6495ED;width:50%;vertical-align:top;border-radius:3px;"></td>
            <td style="background-color:#6495ED;width:500px;vertical-align:top;height:250px;">

                <table width="1050px;" id="userleave" border="3" bgcolor="white" class='familyclass'style="border-radius:10px;text-align:center;margin-top:15%;background-color:white;border-color:blue">
                </table><br>
                <button type="submit" onclick="save()"style="margin-left:520px;font-size: 15px;font-family: verdana;border-color:blue;cursor:pointer;">save</button>
            </td>
            <td style="background-color:#6495ED;width:50%;vertical-align:top;border-radius:3px;"></td>   
        </tr>
        
    </table> 
<!-- <table id="userleave" border="3" bgcolor="white" class='familyclass'style="border-radius:10px;float:top;text-align:center;margin-top:-20px;background-color:white;border-color:blue">
    </table> -->
    
</div><br>   
<input type="hidden" value="" id="recordLength"> 
<link rel="stylesheet" href="{{STATIC_URL}}css/styles.css">
<script src="{{ STATIC_URL }}js/min.js"></script>
<script src="{{ STATIC_URL }}js/jquery.js"></script>
<script>
  $(document).ready(function(){
  $("#signup_popup").click(function(){
      $("#popup1").fadeIn("slow");
      $("#popup_modal1").fadeIn("slow");
  });
    $("#close").click(function(){
      $("#popup1").fadeOut("slow");
      $("#popup_modal1").fadeOut("slow");      
  });

  });

</script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
<script src="{{STATIC_URL}}js/jquery.min.js"></script>
<script src="{{STATIC_URL}}js/jquery-1.9.1.min.js"></script>
<script type="text/javascript">
function subject(){
	// alert('a')
	$.ajax({
      type:'POST',
      url:'/formdis/',
      data:{
      	csrfmiddlewaretoken: '{{csrf_token}}',
      },
    success : function(response){
      var data=response['data'];
      var str_head = '<th>&nbsp;&nbsp;&nbsp;User</th><th>&nbsp;&nbsp;&nbsp&nbsp;&nbsp;Leave Type </th><th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From Date </th><th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To Date </th><th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Timeoff</th><th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;No.Of Days Applying</th><th> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Remarks </th><th>&nbsp;&nbsp;&nbsp;&nbsp;Available_leave</th><th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Status</th><th>&nbsp;&nbsp;&nbsp;&nbsp;Choose</th>'
      var str ='';
      document.getElementById('recordLength').value = data.length;
      
      for(i=0;i<data.length;i++)
  		{
          
          var available_leave = data[i]['available_leave'];
      		var user=data[i]['user'];
      		var leave_type=data[i]['leave_type'];
      		var From_date=data[i]['From_date'];
          var To_date=data[i]['To_date'];
          var Timeoff=data[i]['Timeoff'];
          var WDay_apply	=data[i]['WDay_apply'];
          var Remarks=data[i]['Remarks'];
          var Id=data[i]['id'];
            
            str += '<span><tr><td>&nbsp;&nbsp;&nbsp;'+user+'</td><td>&nbsp;&nbsp;&nbsp;'+leave_type+'</td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'+From_date+'</td><td>&nbsp;&nbsp;&nbsp;&nbsp;'+To_date+'</td><td>&nbsp;&nbsp;&nbsp;&nbsp;'+Timeoff+'</td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'+WDay_apply+'</td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'+Remarks+'</td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'+available_leave+'</td><td>&nbsp;<select id="status'+i+'"><option value="Approve">Approve</option><option value="Pending">Pending</option><option value="Reject">Reject</option></select></td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" id="Choose" value="savedata"></td>'+'<input type="hidden" id="id'+i+'" value="'+Id+'">'+'<input type="hidden" id="user'+i+'" value="'+user+'">'+'<input type="hidden" id="leave_type'+i+'" value="'+leave_type+'">'+'<input type="hidden" id="From_date'+i+'" value="'+From_date+'">'+'<input type="hidden" id="To_date'+i+'" value="'+To_date+'">'+'<input type="hidden" id="Timeoff'+i+'" value="'+Timeoff+'">'+'<input type="hidden" id="WDay_apply'+i+'" value="'+WDay_apply+'">'+'<input type="hidden" id="Remarks'+i+'" value="'+Remarks+'">'+'<input type="hidden" id="available_leave'+i+'" value="'+available_leave+'"></tr></span>';
            
        }
            var html = '<table><tr>'+str_head +'</tr>'+ str+'</table>';
            $('.familyclass').append(html)
            
      },
    });
  }
  $( document ).ready(function() {
    console.log( "ready!" );
    subject();
});
function save(){
  var checkedValue = $('#Choose:checked').is(':checked');

  // var checkedValue = $('#Choose').is(':checked');
  // var checkedValue = document.querySelector('#Choose:checked').value;
  console.log('save')
  console.log(checkedValue)
	var recCount = document.getElementById('recordLength').value;
	var leaves = new Array(recCount -1);
	for(i = 0; i < recCount; i++)
	{
    // i = 0;
		var leave = {
			LeaveID: document.getElementById('id'+i).value,
			Status: document.getElementById('status'+i).value,
      Choose: checkedValue,
			User: document.getElementById('user'+i).value,
			Leave_type: document.getElementById('leave_type'+i).value,
			From_date: document.getElementById('From_date'+i).value,
      To_date :document.getElementById('To_date'+i).value,
      Timeoff :document.getElementById('Timeoff'+i).value,
      WDay_apply :document.getElementById('WDay_apply'+i).value,
      
      
      Remarks:document.getElementById('Remarks'+i).value,
			// LeaveID_id: document.getElementById('id0').value,
			// Status: document.getElementById('status0').value
		}
    $.ajax({
      type:'POST',
      url:'/statusform/',
      data:{
        leave:leave,
        csrfmiddlewaretoken: '{{csrf_token}}'
        },
      success: function (response) {
        console.log(response)
          if(response=='saved') {
            alert('Status Saved...')
          }
          else if (response=='nothing') {
            alert('Nothing to Save!')
          }
          else if (response=='error') {
          alert('There is no Available Leave')
        }  
          
          }
      });

		leaves[i] = leave,
    console.log('gg')
		console.log(leave);

	};

}

function adduser(){
  var username=document.getElementById('username').value;
    var password = document.getElementById('password').value;
    var gender = document.getElementById('gender').value;
    var dob = document.getElementById('dob').value;
    var mail=document.getElementById('mail').value;
    var mob=document.getElementById('mob').value;  
    var all={
      username:username,
      password:password,
      gender:gender,
      dob:dob,
      mail:mail,
      mob:mob,
       
    };    

    $.ajax({
      type:'POST',
      url:'/createaccount/',
      data:{
           all:all,
         csrfmiddlewaretoken: '{{csrf_token}}'
      },
    success: function (response) {
        console.log(response);
        if (response=="saved"){
          // window.location.href='/signup/';
          alert('you successfully registered');
        }
        else if(response=="registered"){
          alert('username already exist!');
        }
      }
    });
}

</script>


    
</script>
</body>
</html>